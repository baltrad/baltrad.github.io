<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Supervisor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="BALTRAD-doxlogo.png"></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Frequently Asked Questions and User Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Supervisor </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section date"><dt>Date</dt><dd>May 2019 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>3.0</dd></dl>
<ol type="1">
<li><a class="el" href="supervisor.html#supervisor_overview">Overview</a></li>
<li><a class="el" href="supervisor.html#supervisor_admin">Administration</a></li>
<li><a class="el" href="supervisor.html#supervisor_qinterface">Query interface</a></li>
<li><a class="el" href="supervisor.html#supervisor_returncodes">Return codes</a></li>
<li><a class="el" href="supervisor.html#supervisor_formatting">Formatting of responses</a></li>
<li><a class="el" href="supervisor.html#supervisor_reporters">Reporters API</a></li>
<li><a class="el" href="supervisor.html#supervisor_reporters_db_status">Reporter name: db.status</a></li>
<li><a class="el" href="supervisor.html#supervisor_reporters_bdb_status">Reporter name: bdb.status</a></li>
<li><a class="el" href="supervisor.html#supervisor_reporters_bdb_args">Arguments</a></li>
<li><a class="el" href="supervisor.html#supervisor_reporters_radar_connection_status">Reporter name: radar.connection.status</a></li>
<li><a class="el" href="supervisor.html#supervisor_reporters_bdb_object_status">Reporter name: bdb.object.status</a></li>
</ol>
<h1><a class="anchor" id="supervisor"></a>
Supervisor</h1>
<h2><a class="anchor" id="supervisor_overview"></a>
Overview</h2>
<p>The supervisor provides a query interface API that can be used for monitoring the state of the node. It is possible to query things like db status, bdb status, product availability and more. If it is necessary to push status information to an external monitoring tool it can be solved by writing a scheduled rule and queries the node for system information.</p>
<h2><a class="anchor" id="supervisor_admin"></a>
Administration</h2>
<p>The supervisor only provides requestors about current state of the node so there is no real need for authentication procedures. However, we have added an IP-block in the supervisor query interface so that we at least can avoid processing unessecary questions. The supervisor administration interface can be reached by navigating to: Processing-&gt;Supervisor.</p>
<div class="image">
<img src="supervisor_admin.png" alt=""/>
</div>
<p>The supervisor will always allow connections from 127.0.0.1. The rest of the ip-addresses that should be allowed should be added in this administration GUI. The format of the ip-address should always be N.N.N.N where N either can be a value between 0-255 or a *. There is actually not a test if the number is &gt; 255 but it will make the filter useless. Also, remember that if you are using a proxy, the ip-package might contain an ip-address different than what you expect.</p>
<p>The supervisor GUI shows the ip-address from where you are connecting so if you are in doubt, you can always login to the supervisor GUI and see what ip-address you should put in the filter.</p>
<h2><a class="anchor" id="supervisor_qinterface"></a>
Query interface</h2>
<p>Basic usage is to send a http-get query towards the supervisor and parse, check the response. The following query</p>
<div class="fragment"><div class="line">wget -q -O- <span class="stringliteral">&quot;http://localhost:8080/BaltradDex/supervisor.htm?reporters=bdb.object.status&amp;sources=seang&amp;objects=SCAN&amp;minutes=5&quot;</span></div>
</div><!-- fragment --><p>would result in the following response</p>
<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line"> </div>
<div class="line">&lt;system-status&gt;</div>
<div class="line">&lt;reporter name=<span class="stringliteral">&quot;bdb.object.status&quot;</span> value=<span class="stringliteral">&quot;sources=seang&amp;amp;objects=SCAN&amp;amp;minutes=5&quot;</span> status=<span class="stringliteral">&quot;OK&quot;</span>/&gt;</div>
<div class="line">&lt;/system-status&gt;</div>
</div><!-- fragment --><p>which says that the bdb.object.status reporter determined that a seang SCAN has arrived within the last 5 minutes.</p>
<p>Each reporter supports different attributes and these combinations is described by each reporter. It is possible to add more than one reporter in the same query and that is controlled by the reporters attribute. This means that if you for example combine two different reporters you should consider that the reporters might use the same attribute which might not be the wanted behaviour. Each reporter will produce a separate &lt;reporter /&gt; entry that can be parsed separately.</p>
<p>As an example, if you want to know the db, bdb and bdb object status, this query </p><div class="fragment"><div class="line">wget -q -O- <span class="stringliteral">&quot;http://localhost:8080/BaltradDex/supervisor.htm?reporters=bdb.status,db.status,bdb.object.status&amp;sources=seang&amp;objects=SCAN&amp;minutes=5&quot;</span></div>
</div><!-- fragment --><p>will produce</p>
<div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line"> </div>
<div class="line">&lt;system-status&gt;</div>
<div class="line">&lt;reporter name=<span class="stringliteral">&quot;bdb.status&quot;</span> value=<span class="stringliteral">&quot;&quot;</span> status=<span class="stringliteral">&quot;OK&quot;</span>/&gt;</div>
<div class="line">&lt;component name=<span class="stringliteral">&quot;db.status&quot;</span> value=<span class="stringliteral">&quot;&quot;</span> status=<span class="stringliteral">&quot;OK&quot;</span>/&gt;</div>
<div class="line">&lt;reporter name=<span class="stringliteral">&quot;bdb.object.status&quot;</span> value=<span class="stringliteral">&quot;sources=seang&amp;amp;objects=SCAN&amp;amp;minutes=5&quot;</span> status=<span class="stringliteral">&quot;OK&quot;</span>/&gt;</div>
<div class="line">&lt;/system-status&gt;</div>
</div><!-- fragment --><p>that says that the baltrad db, postgres connection are working ok and that we got a SCAN from seang within the last 5 minutes.</p>
<h2><a class="anchor" id="supervisor_returncodes"></a>
Return codes</h2>
<p>The &lt;reporter&gt; tag contains a status attribute that specifies what the result of the operation was. This result can actually more than one if the reporter identifies a conflicting state. For example, if asking for two radar sources in the same query and one of the radar sources has delivered within asked time but the other radar source hasn't. In that case, the result would be OK|COMMUNICATION_PROBLEM or similar.</p>
<table class="doxtable">
<tr>
<td>status code </td><td>Description  </td></tr>
<tr>
<td>OK </td><td>All seems ok  </td></tr>
<tr>
<td>COMMUNICATION_PROBLEM </td><td>There is some problem related to communication  </td></tr>
<tr>
<td>MEMORY_PROBLEM </td><td>We have identified that we might be leaking memory  </td></tr>
<tr>
<td>EXCHANGE_PROBLEM </td><td>We have problems exchanging data  </td></tr>
<tr>
<td>PROCESSING_PROBLEM </td><td>An error occured when trying to process data  </td></tr>
</table>
<h2><a class="anchor" id="supervisor_formatting"></a>
Formatting of responses</h2>
<p>Currently, the only supported formatter is the xml formatter. In the future we hope that you will have access to various kinds of formatters that is more suitable for your use. The formatter is specified by a separate attribute called named <b>format</b> and the value would be <b>xml</b>. However, this is default behaviour so it can be omitted.</p>
<p>If you want to manually specify the formatter, then the request url would be: </p><div class="fragment"><div class="line">http:<span class="comment">//..../BaltradDex/supervisor.htm?format=xml&amp;reporter=......</span></div>
</div><!-- fragment --><p>The format of the returned xml message will always be in the format: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line"> </div>
<div class="line">&lt;system-status&gt;</div>
<div class="line">[&lt;reporter name=<span class="stringliteral">&quot;...&quot;</span> value=<span class="stringliteral">&quot;...&quot;</span> status=<span class="stringliteral">&quot;...&quot;</span>/&gt;]*</div>
<div class="line">&lt;/system-status&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="supervisor_reporters"></a>
Reporters API</h2>
<p>There are several reporters delivered with the system and this list will probably grow with time.</p>
<h2><a class="anchor" id="supervisor_reporters_db_status"></a>
Reporter name: db.status</h2>
<p>This reporter will just verify that a query can be executed towards the postgres database.</p>
<h3><a class="anchor" id="supervisor_reporters_db_args"></a>
Arguments</h3>
<p>N/A</p>
<h3><a class="anchor" id="supervisor_reporters_db_example"></a>
Example usage</h3>
<p>Query: </p><div class="fragment"><div class="line">wget -q -O- <span class="stringliteral">&quot;http://localhost:8080/BaltradDex/supervisor.htm?reporters=db.status&quot;</span></div>
</div><!-- fragment --><p>Response: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line"> </div>
<div class="line">&lt;system-status&gt;</div>
<div class="line">&lt;reporter name=<span class="stringliteral">&quot;db.status&quot;</span> value=<span class="stringliteral">&quot;&quot;</span> status=<span class="stringliteral">&quot;OK&quot;</span>/&gt;</div>
<div class="line">&lt;/system-status&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="supervisor_reporters_bdb_status"></a>
Reporter name: bdb.status</h2>
<p>This reporter will verify that the node has connection with the bdb server.</p>
<h2><a class="anchor" id="supervisor_reporters_bdb_args"></a>
Arguments</h2>
<p>N/A</p>
<h3><a class="anchor" id="supervisor_reporters_bdb_example"></a>
Example usage</h3>
<p>Query: </p><div class="fragment"><div class="line">wget -q -O- <span class="stringliteral">&quot;http://localhost:8080/BaltradDex/supervisor.htm?reporters=bdb.status&quot;</span></div>
</div><!-- fragment --><p>Response: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line"> </div>
<div class="line">&lt;system-status&gt;</div>
<div class="line">&lt;reporter name=<span class="stringliteral">&quot;bdb.status&quot;</span> value=<span class="stringliteral">&quot;&quot;</span> status=<span class="stringliteral">&quot;OK&quot;</span>/&gt;</div>
<div class="line">&lt;/system-status&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="supervisor_reporters_radar_connection_status"></a>
Reporter name: radar.connection.status</h2>
<p>This reporter can be used to control if a radar has been able to provide the composites and volumes with data without causing a timeout. If, for example, a composite is expecting a scan from searl and this scan does not arrive within the timeout. Then, this reporter will know about that. This reporter is a faster version of a product tester but not as accurate as the <a class="el" href="supervisor.html#supervisor_reporters_bdb_object_status">bdb object status reporter</a>.</p>
<h3><a class="anchor" id="supervisor_reporters_radar_connection_args"></a>
Arguments</h3>
<table class="doxtable">
<tr>
<td>Name </td><td>Description  </td></tr>
<tr>
<td>sources </td><td>A comma separated list of source names, e.g. searl,seang  </td></tr>
</table>
<h3><a class="anchor" id="supervisor_reporters_radar_connection_example"></a>
Example usage</h3>
<p>Query: </p><div class="fragment"><div class="line">wget -q -O- <span class="stringliteral">&quot;http://localhost:8080/BaltradDex/supervisor.htm?reporters=radar.connection.status&amp;sources=searl,seang&quot;</span></div>
</div><!-- fragment --><p>Response: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line"> </div>
<div class="line">&lt;system-status&gt;</div>
<div class="line">&lt;reporter name=<span class="stringliteral">&quot;radar.connection.status&quot;</span> value=<span class="stringliteral">&quot;sources=searl,seang&quot;</span> status=<span class="stringliteral">&quot;OK&quot;</span>/&gt;</div>
<div class="line">&lt;/system-status&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="supervisor_reporters_bdb_object_status"></a>
Reporter name: bdb.object.status</h2>
<p>This reporter is currently the most advanced reporter mechanism. It queries the baltrad db for availability of objects (SCAN,PVOL,COMP,...) for sources (searl, seang, ...) and areas (swegmaps_2000, ...) within a specific time limit in minutes. This means that you are able to query for almost anything within the database and verify if you have got it in time. However, the caveat to this is that it is a quite expensive version of reporter so make sure that you don't affect perforance drastically by calling this reporter too frequently. You might notice that the performance for handling incomming data will decrease if you continuously call this reporter.</p>
<h3><a class="anchor" id="supervisor_reporters_bdb_object_args"></a>
Arguments</h3>
<table class="doxtable">
<tr>
<td>Name </td><td>Description  </td></tr>
<tr>
<td>minutes </td><td>The time limit backward in time to check in minutes. E.g. 5. Default 5  </td></tr>
<tr>
<td>objects </td><td>A comma separated list of what/object types that should be looked up, for example SCAN,PVOL,COMP  </td></tr>
<tr>
<td>sources </td><td>A comma separated list of sources (used with SCAN,PVOL,...), for example searl,seang  </td></tr>
<tr>
<td>areas </td><td>A comma separated list of sources (used with COMP,...), for example swegmaps_2000  </td></tr>
</table>
<p>You can combine for example SCAN,PVOL and COMP together with a list of sources and areas.</p>
<h3><a class="anchor" id="supervisor_reporters_bdb_object_example"></a>
Example usage</h3>
<p>Query if a SCAN from seang and a COMP for area swegmaps_2000 has arrived within the last 5 minutes.</p>
<div class="fragment"><div class="line">wget -q -O- <span class="stringliteral">&quot;http://localhost:8080/BaltradDex/supervisor.htm?reporters=bdb.object.status&amp;sources=seang&amp;areas=swegmaps_2000&amp;objects=SCAN,COMP&amp;minutes=5&quot;</span></div>
</div><!-- fragment --><p>Response: </p><div class="fragment"><div class="line">&lt;?xml version=<span class="stringliteral">&quot;1.0&quot;</span> encoding=<span class="stringliteral">&quot;UTF-8&quot;</span>?&gt;</div>
<div class="line"> </div>
<div class="line">&lt;system-status&gt;</div>
<div class="line">&lt;reporter name=<span class="stringliteral">&quot;bdb.object.status&quot;</span> value=<span class="stringliteral">&quot;sources=seang&amp;amp;areas=swegmaps_2000&amp;amp;objects=SCAN&amp;amp;minutes=5&quot;</span> status=<span class="stringliteral">&quot;OK&quot;</span>/&gt;</div>
<div class="line">&lt;/system-status&gt;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->

<hr class="footer"/><address class="footer"><small>
</a><a href="mailto:support@baltrad.eu">support@baltrad.eu</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generated on Fri Oct 1 2021 08:50:17 by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/> 1.9.1 for <a href="http://baltrad.eu/" target="_blank"><img class="footer" src="foot_BALTRAD-doxlogo.png" /></a></small></address>
</body>
</html>
